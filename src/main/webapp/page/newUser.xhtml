<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
    <script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
</h:head>
<body>
<h:form id="generalForm" style="width:50%" enctype="multipart/form-data" >
    <p:messages showDetail="true"/>

            <p:panelGrid>
                <p:row>
                    <p:column><p:outputLabel value="User Name"/></p:column>
                    <p:column><p:inputText value="#{userBean.newUserName}" required="true"/></p:column>
                </p:row>

                <p:row>
                    <p:column><p:outputLabel value="Password"/></p:column>
                    <p:column><p:password value="#{userBean.newPassword}" required="true"/></p:column>
                </p:row>

                <p:row>
                    <p:column><p:outputLabel value="Repeat password"/></p:column>
                    <p:column><p:password value="#{userBean.newRepeatPassword}" required="true"/></p:column>
                </p:row>

                <p:row>
                    <p:column><p:outputLabel value="Email"/></p:column>
                    <p:column><p:inputText value="#{userBean.newEmail}" required="true"/></p:column>
                </p:row>

                <p:row>
                    <p:column><p:outputLabel value="Your public Name"/></p:column>
                    <p:column><p:inputText value="#{userBean.newPublicName}" required="true"/></p:column>
                </p:row>

                <p:row>
                    <p:column><p:outputLabel value="Your public ID"/></p:column>
                    <p:column><p:inputText value="#{userBean.newPublicId}" required="true"/></p:column>
                </p:row>

                <p:row>
                    <p:column><p:outputLabel value="Profile photo"/></p:column>
                    <p:column><p:fileUpload fileUploadListener="#{userBean.handleFileUpload}" mode="advanced" dragDropSupport="false"
                              sizeLimit="100000" fileLimit="1" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" /></p:column>
                </p:row>

                <p:row>
                    <p:column colspan="2"><p:captcha label="Captcha" language="en" theme="white"/></p:column>
                </p:row>

                <p:row>
                    <p:column><p:outputLabel value="I'll host the events"/></p:column>
                    <p:column><p:selectBooleanCheckbox value="#{userBean.newHost}" /></p:column>
                </p:row>

            </p:panelGrid>

            <p:panel header="For track owners" toggleable="true" collapsed="true">
                <h:inputHidden id="lat" value="#{userBean.newLat}" />
                <h:inputHidden id="lng" value="#{userBean.newLng}" />

                <p:panelGrid>
                    <p:row>
                        <p:column><p:outputLabel value="FB Application ID"/></p:column>
                        <p:column><p:inputText value="#{userBean.newFBId}" required="false"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Logo"/></p:column>
                        <p:column><p:fileUpload fileUploadListener="#{userBean.handleLogoUpload}" mode="advanced" dragDropSupport="false"
                                  sizeLimit="100000" fileLimit="1" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" /></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Track scheme"/></p:column>
                        <p:column><p:fileUpload fileUploadListener="#{userBean.handleSchemeUpload}" mode="advanced" dragDropSupport="false"
                                  sizeLimit="100000" fileLimit="1" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" /></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Country"/></p:column>
                        <p:column><p:inputText value="#{userBean.newCountry}"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="City"/></p:column>
                        <p:column><p:inputText value="#{userBean.newCity}"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Address"/></p:column>
                        <p:column><p:inputText value="#{userBean.newAddress}"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column colspan="2">
                            <p:gmap id="gmap" center="52.5,13.5" zoom="13" type="HYBRID"
                                    style="width:600px;height:400px"
                                    model="#{userBean.emptyModel}"
                                    onPointClick="handlePointClick(event);"
                                    widgetVar="map" />
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </p:panel>
            <p:commandButton value="Register" actionListener="#{userBean.register}" ajax="false"/>
            <script type="text/javascript">
                var currentMarker = null;

                function handlePointClick(event) {
                    if(currentMarker === null) {
                        document.getElementById('generalForm:lat').value = event.latLng.lat();
                        document.getElementById('generalForm:lng').value = event.latLng.lng();

                        currentMarker = new google.maps.Marker({
                            position:new google.maps.LatLng(event.latLng.lat(), event.latLng.lng())
                        });

                        PF('map').addOverlay(currentMarker);
                    } else {
                        currentMarker.setMap(null);
                        currentMarker = null;
                        handlePointClick(event);
                    }
                }
            </script>
        </h:form>
</body>
</html>